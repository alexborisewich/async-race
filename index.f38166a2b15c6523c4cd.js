(()=>{"use strict";var e={849:(e,t,n)=>{n.r(t)},485:(e,t,n)=>{n.r(t)},717:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(527));t.default=class{constructor(){this.appView=new a.default}start(){this.appView.renderView(),this.appView.addHandlers()}}},883:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,n,r){this.baseUrl=e,this.carsPath=t,this.enginePath=n,this.winnersPath=r}errorHandler(e){console.warn(`${e.status}: ${e.statusText}`)}getQueryString(e){return e.length?`?${e.map((e=>`${e.name}=${e.value}`)).join("&")}`:""}getCars(e=[]){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.carsPath}${this.getQueryString(e)}`);return t.ok?{items:yield t.json(),count:Number(t.headers.get("X-Total-Count"))}:this.errorHandler(t)}))}getCar(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.carsPath}/${e}`);return t.ok?t.json():this.errorHandler(t)}))}createCar(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.carsPath}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t.ok?t.json():this.errorHandler(t)}))}deleteCar(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.carsPath}/${e}`,{method:"DELETE"});return t.ok?t.json():this.errorHandler(t)}))}updateCar(e,t){return n(this,void 0,void 0,(function*(){const n=yield fetch(`${this.baseUrl}/${this.carsPath}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return n.ok?n.json():this.errorHandler(n)}))}toggleEngineState(e,t){return n(this,void 0,void 0,(function*(){const n=yield fetch(`${this.baseUrl}/${this.enginePath}?id=${e}&status=${t}`,{method:"PATCH"});return n.ok?n.json():this.errorHandler(n)}))}enableEngineDrive(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.enginePath}?id=${e}&status=drive`,{method:"PATCH"});return t.ok?t.json():this.errorHandler(t)}))}getWinners(e=[]){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.winnersPath}${this.getQueryString(e)}`);return t.ok?{items:yield t.json(),count:Number(t.headers.get("X-Total-Count"))}:this.errorHandler(t)}))}getWinner(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.winnersPath}/${e}`);return t.ok?t.json():this.errorHandler(t)}))}createWinner(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.winnersPath}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t.ok?t.json():this.errorHandler(t)}))}deleteWinner(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(`${this.baseUrl}/${this.winnersPath}/${e}`,{method:"DELETE"});t.ok||this.errorHandler(t)}))}updateWinner(e,t){return n(this,void 0,void 0,(function*(){const n=yield fetch(`${this.baseUrl}/${this.winnersPath}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return n.ok?n.json():this.errorHandler(n)}))}}},357:(e,t)=>{var n,r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.Sort=t.EngineState=t.Url=void 0,(a=t.Url||(t.Url={})).base="http://127.0.0.1:3000",a.garage="garage",a.winners="winners",a.engine="engine",(r=t.EngineState||(t.EngineState={})).start="start-engine",r.stop="stop-engine",r.started="started",r.stopped="stopped",(n=t.Sort||(t.Sort={})).byWins="wins",n.byTime="time",n.orderUp="ASC",n.orderDown="DESC"},527:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(883)),i=n(357),s=r(n(377)),o=r(n(183));t.default=class{constructor(){this.api=new a.default(i.Url.base,i.Url.garage,i.Url.engine,i.Url.winners),this.garageContainer=document.querySelector(".garage"),this.garage=new s.default(this.garageContainer,this.api),this.winnersContainer=document.querySelector(".winners"),this.winners=new o.default(this.winnersContainer,this.api)}renderView(){try{this.garage.createGarageLayout(),this.garage.renderCars(),this.winners.createWinnersTable(),this.winners.renderWinners()}catch(e){console.error("Error")}}addHandlers(){this.garage.addCreateCarHandler(),this.garage.addUpdateCarHandler(),this.garage.addGenerateCarsHandler(),this.garage.addSelectCarHandler(),this.garage.addRemoveCarHandler(),this.garage.addAnimationCarHandler(),this.garage.resetAnimationCarHandler(),this.garage.addRaceHandler(),this.garage.resetCarsHandler(),this.garage.addPaginationHandler(),this.winners.addUpdateWinnersHandler(),this.winners.addSortWinnerHandler(),this.winners.addPaginationHandler()}}},314:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createWinnerCar=t.createRandomCar=t.createCar=void 0;const n=["Audi","Kia","Ford","Honda","Acura","BMW","Opel","Fiat","Dodge","Mazda","Volvo"],r=["A6","Rio","Ka","Fit","TSX","X5","Astra","500","RAM","CX-5","XC-90"];function a(e){return Math.floor(Math.random()*e)}function i(){const e="0123456789ABCDEF";let t="";for(let n=0;n<6;n+=1)t+=e[a(e.length)];return t}function s(e){return`<svg width="83" height="40" viewBox="0 0 83 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <g clip-path="url(#clip0_2_2)"><path fill-rule="evenodd" clip-rule="evenodd" d="M82.2853 20.1106C81.7633 34.9996\n  79.7161 39.5144 57.8346 37.8653C57.23 37.6067 56.6255 37.3473 56.0218 37.0887C45.924 37.3939 35.7651 37.6991 25.7292\n  37.0887C24.6465 38.0798 23.1975 37.6067 21.9317 37.8653C18.6717 38.2892 14.0696 38.469 9.58965 38.0383C-0.474297\n  37.3176 0.446463 26.8323 0.269264 20.8635C0.417636 14.2121 -1.752 5.24108 9.50401 2.73994C14.6928 2.49542 18.8439\n  2.43438 24.5211 2.73952C24.9526 2.96962 25.3833 3.19981 25.8148 3.42992C35.7897 3.15208 45.5815 2.81319 56.105\n  3.32868C56.9392 3.02354 57.7735 2.7184 58.607 2.41326C80.1705 1.29445 81.5325 5.54596 82.2853 20.1104V20.1106Z"\n  fill="${e}" stroke="black" stroke-width="0.75"/><path fill-rule="evenodd" clip-rule="evenodd" d="M62.5809\n  5.76013C70.32 12.5784 70.9817 27.8542 62.4945 34.4995C58.4672 34.0391 54.44 33.5788 50.4118 33.1193C51.8218 26.8477\n  53.3174 16.9508 49.9803 7.31422C54.1805 6.79593 58.3807 6.27816 62.5809 5.7603V5.76013Z" fill="black"\n  fill-opacity="0.83065" stroke="black" stroke-width="1.33333"/><path fill-rule="evenodd" clip-rule="evenodd"\n  d="M22.5356 8.43561C21.6436 16.8363 21.0976 24.632 22.9671 32.0829H10.6259C5.70665 24.6896 5.96525 15.7424 10.3672\n  8.60774C14.4234 8.55049 18.4794 8.49298 22.5356 8.43541V8.43561Z" fill="black" fill-opacity="0.83065" stroke="black"\n  stroke-width="1.33333"/><path d="M78.2905 32.8398C78.2761 32.8703 78.2564 32.9077 78.2321 32.9518C78.1764 33.051\n  78.0997 33.1751 78.0046 33.3163C77.8144 33.5986 77.5587 33.9385 77.2741 34.2695C76.9882 34.6014 76.68 34.9169 76.3849\n  35.1553C76.0951 35.3893 75.8544 35.5184 75.6826 35.5511C75.2676 35.525 75.0118 35.4497 74.8649 35.3595C74.7344 35.2799\n  74.6859 35.1889 74.678 35.0623C74.6689 34.9094 74.7213 34.686 74.8702 34.3765C75.0151 34.0754 75.2367 33.7235 75.5259\n  33.3216C75.9476 32.827 76.3233 32.4458 76.6538 32.1814C76.9921 31.9108 77.2544 31.7866 77.4479 31.7605C77.6125 31.7383\n  77.7489 31.7831 77.8859 31.9392C78.0295 32.1026 78.1705 32.3879 78.2905 32.8398Z" fill="white" stroke="black"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M78.718 7.5459C78.3725 9.69482 77.2262 9.44131 75.3423 7.55921C74.019\n  6.0067 73.7371 5.0193 75.5495 4.77164C76.6223 4.82922 78.5672 7.11069 78.718 7.5459Z" fill="white" stroke="black"\n  stroke-width="1.33333"/><path fill-rule="evenodd" clip-rule="evenodd" d="M59.5601 4.72451C47.0747 3.94779 35.539\n  4.12042 23.4851 4.55188C21.3561 4.89712 19.1407 5.15606 17.0127 5.50122C22.2625 6.55127 33.3379 7.21291 43.7664\n  6.7095C49.3766 6.2636 54.2526 5.55878 59.5601 4.72451Z" fill="black" fill-opacity="0.83065" stroke="black"\n  stroke-width="1.33333"/><path fill-rule="evenodd" clip-rule="evenodd" d="M60.5359 35.8712C48.0506 36.6478 36.5148\n  36.4757 24.461 36.0442C22.3321 35.6982 20.1166 35.4397 17.9877 35.0946C23.2384 34.0441 34.3138 33.3828 44.7423\n  33.8864C50.3516 34.3324 55.2285 35.0369 60.5359 35.8712Z" fill="black" fill-opacity="0.83065" stroke="black"\n  stroke-width="1.33333"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.59851 30.5467C5.45313 31.0147 6.97923\n  34.7165 6.42985 35.4287C4.90373 35.9373 3.31741 33.2726 2.95114 32.1941C2.95114 31.2784 3.68368 30.4857 4.59851\n  30.5467Z"fill="#FFB800" stroke="black" stroke-width="1.33333"/><path fill-rule="evenodd" clip-rule="evenodd"\n  d="M4.44082 10.5003C5.29545 10.0323 6.82074 6.33031 6.27132 5.61838C4.74604 5.10975 3.15888 7.77462 2.79346\n  8.85272C2.79346 9.76773 3.52515 10.5613 4.44082 10.5003Z" fill="#FFB800" stroke="black" stroke-width="1.33333"/>\n  </g><defs><clipPath id="clip0_2_2"><rect width="82.623" height="40" fill="white"/></clipPath></defs></svg>`}function o(e){const t=document.createElement("li");return t.classList.add("car-tracks__item","car-track"),t.dataset.car=`${e.id}`,t.innerHTML=`<div class="car-track__ctrl">\n    <button class="car-track__btn-select btn" id="btn-select-car" data-color="${e.color}"\n            data-car="${e.id}">Select</button>\n    <button class="car-track__btn-remove btn" id="btn-remove-car" data-car="${e.id}">remove</button>\n    <button class="car-track__btn-start-engine btn" id="start-engine" data-car="${e.id}">start</button>\n    <button class="car-track__btn-stop-engine btn" id="stop-engine"\n            data-car="${e.id}" disabled>stop</button>\n    </div>\n    <div class="car-track__road road">\n    <p class="road__title-model">${e.name}</p>\n    ${s(e.color)}\n    </div>`,t.querySelector("svg").classList.add("car-track__car-img","car"),t}t.createCar=o,t.createRandomCar=function(){return{name:`\n  ${n[a(n.length)]}\n  ${r[a(r.length)]}\n  `,color:`#${i()}`}},t.createWinnerCar=function(e,t,n){const r=document.createElement("tr");return r.classList.add("table__row"),r.innerHTML=`<td class="table__cell" scope="row">${n}</td>\n    <td class="table__cell">${s(e.color)}</td>\n    <td class="table__cell">${e.name}</td>\n    <td class="table__cell">${t.wins}</td>\n    <td class="table__cell">${t.time}</td>`,r},t.default=o},377:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(134),i=n(357),s=n(314);t.default=class{constructor(e,t){this.container=e,this.api=t,this.drawAnimationCar=(e,t,n,a,s,o)=>r(this,void 0,void 0,(function*(){const r=yield this.api.toggleEngineState(t,i.EngineState.started);let c=!0;s.addEventListener("click",(()=>c=!1)),a.addEventListener("click",(()=>c=!1));const d=this.api.enableEngineDrive(t).then((e=>c?e?{id:t,wins:1,time:Math.round(r.distance/r.velocity)/1e3,name:o}:(c=!1,void(a.innerHTML="reset")):void 0)),l=performance.now();return requestAnimationFrame((function t(i){let s=(i-l)/(r.distance/r.velocity);s>1&&(a.innerHTML="reset",s=1),e.style.transform=`translateX(${s*(n-e.getBoundingClientRect().width)}px)`,s<1&&c&&requestAnimationFrame(t)})),a.disabled=!1,a.previousElementSibling.disabled=!0,d})),this.pageNum=1}createGarageLayout(){const e=document.createElement("ul");e.classList.add("garage__settings-list","settings"),e.innerHTML='<li class="settings__item">\n      <input class="settings__set-name input-name" type="text" id="set-name" name="set-name"\n              placeholder="Please enter name a car here...">\n      <input class="settings__set-color input-color" type="color" id="set-color" name="set-color" value="#ffffff">\n      <input class="settings__btn-set btn" type="submit" value="create" id="btn-set">\n      </li>\n      <li class="settings__item">\n      <input class="settings__upd-name input-name upd" type="text" id="upd-name" name="upd-name"\n              placeholder="Please enter new name a car here..." disabled>\n      <input class="settings__upd-color input-color upd" type="color" id="upd-color" name="upd-color" value="#ffffff"\n              disabled>\n      <input class="settings__btn-upd btn upd" type="submit" id="btn-upd" value="update" disabled>\n      </li>',this.container.prepend(e);const t=document.createElement("div");t.classList.add("garage__control"),t.innerHTML=`${(0,a.createInfoBlock)("garage").outerHTML}\n      <div class="garage__control-container">\n      <button class="garage__btn-generate btn" id="btn-generate">generate cars</button>\n      <button class="garage__btn-start-race btn" id="btn-start-race">start race</button>\n      <button class="garage__btn-stop-race btn" id="btn-stop-race" disabled>stop race</button>\n      </div>`,this.container.insertBefore(t,this.container.children[1]);const n=document.createElement("ul");n.classList.add("garage__tracks-list","car-tracks"),this.container.insertBefore(n,this.container.children[2])}renderCars(){return r(this,void 0,void 0,(function*(){const e=[{name:"_page",value:this.pageNum},{name:"_limit",value:7}],t=yield this.api.getCars(e);this.container.querySelector(".count-num").textContent=`${t.count}`,this.container.querySelector(".page-num").textContent=`${this.pageNum}`;const n=this.container.querySelector(".car-tracks");n.innerHTML="",t.items.forEach((e=>n.append((0,s.createCar)(e))))}))}prepareCarAnimation(e,t){return r(this,void 0,void 0,(function*(){const n=e.querySelector(".car-track__btn-stop-engine"),r=this.container.querySelector("#btn-stop-race"),a=e.querySelector(".road"),i=a.clientWidth-2*parseInt(getComputedStyle(a,null).paddingLeft),s=e.querySelector(".car");return this.drawAnimationCar(s,Number(e.dataset.car),i,n,r,t)}))}addAnimationCarHandler(){this.container.addEventListener("click",(e=>{const t=e.target;if(t.id===i.EngineState.start){t.disabled=!0;const e=t.nextElementSibling;e.disabled=!1,e.innerHTML="stop";const n=t.closest(".car-track");this.prepareCarAnimation(n)}}))}resetAnimation(e){return r(this,void 0,void 0,(function*(){const t=e.querySelector("#start-engine"),n=e.querySelector("#stop-engine"),r=e.querySelector(".car");t.disabled&&"stop"===n.innerHTML?n.innerHTML="reset":t.disabled&&"reset"===n.innerHTML&&(n.innerHTML="stop",t.disabled=!1,n.disabled=!0),r.style.transform="",yield this.api.toggleEngineState(Number(e.dataset.car),i.EngineState.stopped)}))}resetAnimationCarHandler(){this.container.addEventListener("click",(e=>{const t=e.target;if(t.id===i.EngineState.stop){const e=t.closest(".car-tracks__item");this.resetAnimation(e)}}))}toRaceCars(e){return r(this,void 0,void 0,(function*(){const t=this.container.querySelector("#btn-stop-race"),n=[];e.querySelectorAll(".car-track").forEach((e=>{const t=e.querySelector(".road__title-model").textContent,r=this.prepareCarAnimation(e,t).then((e=>new Promise(((t,n)=>e?t(e):n("Error")))));n.push(r)})),Promise.allSettled(n).then((e=>{e.every((e=>"rejected"===e.status))||(t.innerHTML="reset race")})),Promise.any(n).then((e=>r(this,void 0,void 0,(function*(){if(e){(0,a.createModalWindow)(e.name,e.time);const t=(yield this.api.getWinners()).items;t.length&&t.some((t=>t.id===e.id))?yield this.api.getWinner(e.id).then((t=>r(this,void 0,void 0,(function*(){if(t){const n={wins:t.wins+1,time:t.time<e.time?t.time:e.time};yield this.api.updateWinner(t.id,n)}})))):yield this.api.createWinner({id:e.id,wins:1,time:e.time})}})))).catch((e=>console.warn(e)))}))}addRaceHandler(){return r(this,void 0,void 0,(function*(){const e=this.container.querySelector("#btn-start-race"),t=this.container.querySelector("#btn-stop-race");e.addEventListener("click",(()=>{e.disabled=!0,t.disabled=!1,t.innerHTML="stop race",this.toRaceCars(this.container)}))}))}resetCarsHandler(){const e=this.container.querySelector("#btn-start-race"),t=this.container.querySelector("#btn-stop-race");t.addEventListener("click",(()=>{this.container.querySelectorAll(".car-track").forEach((e=>{this.resetAnimation(e)})),e.disabled&&"stop race"===t.innerHTML?t.innerHTML="reset race":e.disabled&&"reset race"===t.innerHTML&&(t.innerHTML="stop race",t.disabled=!0,e.disabled=!1)}))}addCreateCarHandler(){const e=this.container.querySelector("#set-name"),t=this.container.querySelector("#set-color");this.container.querySelector("#btn-set").addEventListener("click",(()=>{e.value&&t.value?this.api.createCar({name:e.value,color:t.value}):alert("Name and color required for car!"),this.renderCars()}))}addUpdateCarHandler(){const e=this.container.querySelector("#upd-name"),t=this.container.querySelector("#upd-color"),n=this.container.querySelector("#btn-upd");n.addEventListener("click",(()=>{const r=Number(n.dataset.car);e.value&&t.value&&r?this.api.updateCar(r,{name:e.value,color:t.value}):alert("Name and color required for car!"),this.renderCars(),e.value="",t.value="#ffffff",e.disabled=!0,t.disabled=!0,n.disabled=!0}))}addGenerateCarsHandler(){const e=this.container.querySelector("#btn-generate");e.addEventListener("click",(()=>{e.disabled=!0;for(let e=0;e<100;e++)this.api.createCar((0,s.createRandomCar)());this.renderCars(),e.disabled=!1}))}addSelectCarHandler(){const e=this.container.querySelector("#upd-name"),t=this.container.querySelector("#upd-color");this.container.addEventListener("click",(n=>{const r=n.target;if("btn-select-car"===r.id){const n=r.dataset.color,a=r.closest(".car-track").querySelector(".road__title-model");e.value=a.textContent||"",t.value=n||"#ffffff",this.container.querySelector("#btn-upd").dataset.car=String(r.dataset.car),this.container.querySelectorAll(".upd").forEach((e=>{e.disabled=!1}))}}))}addRemoveCarHandler(){return r(this,void 0,void 0,(function*(){this.container.addEventListener("click",(e=>{(()=>{r(this,void 0,void 0,(function*(){const t=e.target;if("btn-remove-car"===t.id){const e=(yield this.api.getWinners()).items;t.disabled=!0,yield this.api.deleteCar(Number(t.dataset.car)),e.length&&e.some((e=>e.id===Number(t.dataset.car)))&&(yield this.api.deleteWinner(Number(t.dataset.car))),yield this.renderCars().then((()=>t.disabled=!1))}}))})()}))}))}addPaginationHandler(){const e=this.container.querySelector("#prev-garage"),t=this.container.querySelector("#next-garage"),n=this.container.querySelector(".count-num");this.container.querySelector(".garage__pagination").addEventListener("click",(r=>{const a=r.target;if(a===e){const n=this.pageNum-1;n>=1&&(this.pageNum=n),1===n&&(e.disabled=!0),t.disabled=!1}else if(a===t){const r=Number(n.textContent),a=Math.ceil(r/7),i=this.pageNum+1;i<=a&&(this.pageNum=i),i===a&&(t.disabled=!0),e.disabled=!1}this.renderCars()}))}}},134:(e,t)=>{function n(e){const t=document.createElement("div");return t.classList.add(`${e}__pagination`),t.innerHTML=`\n  <button class="${e}__pag-btn btn" id="prev-${e}" disabled>Prev</button>\n    <h3 class="${e}__pag-pointer page-pointer"><span class="${e}__page-num page-num"></span></h3>\n  <button class="${e}__pag-btn btn" id="next-${e}">Next</button>`,t}function r(){const e=document.querySelector(".page");var t;!function(e){const t=document.createElement("header");t.classList.add("header"),t.innerHTML='<h1 class="header__logo logo">\n      <a class="header__text" href="#">Async Race</a>\n    </h1>\n    <nav class="header__nav">\n      <button class="header__btn-garage btn" id="garage">GARAGE</button>\n      <button class="header__btn-winners btn" id="winners">WINNERS</button>\n    </nav>',e.prepend(t)}(e),function(e){const t=document.createElement("main");t.classList.add("main"),t.innerHTML='\n  <section class="garage"></section>\n  <section class="winners hide"></section>',t.querySelector(".garage").append(n("garage")),t.querySelector(".winners").append(n("winners")),e.append(t)}(e),function(e){const t=document.createElement("footer");t.classList.add("footer"),t.innerHTML='<p class="footer__year">2022</p><p class="footer__github-link-wrapper">\n  <a class="footer__github-link" href="https://github.com/alexborisewich">github</a></p>\n  <p class="footer__rsschool-link-wrapper"><a class="footer__rsschool-link" href="https://rs.school/js/">\n  <img class="footer__rsschool-img" src="https://rs.school/images/rs_school_js.svg" alt="RSSchool"></a></p>',e.append(t)}(e),(t=e).querySelector(".header__nav").addEventListener("click",(e=>{const n=e.target;if("BUTTON"===n.tagName){const e=t.querySelector(".garage"),r=t.querySelector(".winners");"garage"===n.id?(e.classList.remove("hide"),r.classList.add("hide")):(r.classList.remove("hide"),e.classList.add("hide"))}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.renderBasicLayout=t.createModalWindow=t.createInfoBlock=void 0,t.createInfoBlock=function(e){const t=document.createElement("div");return t.classList.add(`${e}__info`,"info"),t.innerHTML=`<h2 class="${e}__count-pointer count-pointer">${e} total cars:\n    <span class="${e}__count-num count-num"></span>\n    </h2>`,t},t.createModalWindow=function(e,t){const n=document.createElement("div");n.classList.add("page__shadow");const r=document.createElement("div");r.classList.add("page__modal"),r.innerHTML=`${e} went first <span>${t}</span>!`,n.append(r),document.body.append(n),document.body.classList.add("no-scroll"),setTimeout((()=>{n.remove(),document.body.classList.remove("no-scroll")}),3e3)},t.renderBasicLayout=r,t.default=r},183:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(134),i=n(357),s=n(314);t.default=class{constructor(e,t){this.container=e,this.api=t,this.pageNumber=1,this.sort="wins",this.order="DESC"}createWinnersTable(){const e=document.createElement("table");e.classList.add("winners__table","table"),e.innerHTML='<thead class="table__header">\n      <tr class="table__header-row">\n        <th class="table__header-cell" scope="col">№</th>\n        <th class="table__header-cell" scope="col">Car</th>\n        <th class="table__header-cell" scope="col">Name</th>\n        <th class="table__header-cell" data-sort="wins" scope="col">Wins</th>\n        <th class="table__header-cell" data-sort="time" scope="col">Best time (seconds)</th>\n      </tr>\n      </thead>\n      <tbody class="table__body"></tbody>',this.container.prepend(e);const t=(0,a.createInfoBlock)("winners");this.container.prepend(t)}renderWinners(){return r(this,void 0,void 0,(function*(){const e=[{name:"_page",value:this.pageNumber},{name:"_limit",value:10},{name:"_sort",value:this.sort},{name:"_order",value:this.order}],t=yield this.api.getWinners(e);this.container.querySelector(".count-num").textContent=`${t.count}`,this.container.querySelector(".page-num").textContent=`${this.pageNumber}`;const n=this.container.querySelector(".table__body");n.innerHTML="";for(const[e,r]of t.items.entries()){const t=yield this.api.getCar(r.id);n.append((0,s.createWinnerCar)(t,r,Number(e+1)))}}))}addUpdateWinnersHandler(){document.querySelector("#winners").addEventListener("click",(()=>{this.renderWinners()}))}addPaginationHandler(){const e=this.container.querySelector("#prev-winners"),t=this.container.querySelector("#next-winners"),n=this.container.querySelector(".count-num");this.container.querySelector(".winners__pagination").addEventListener("click",(r=>{const a=r.target;if(a===e){const n=this.pageNumber-1;n>=1&&(this.pageNumber=n),1===n&&(e.disabled=!0),t.disabled=!1}else if(a===t){const r=Number(n.textContent),a=Math.ceil(r/10),i=this.pageNumber+1;i<=a&&(this.pageNumber=i),i===a&&(t.disabled=!0),e.disabled=!1}this.renderWinners()}))}addSortWinnerHandler(){this.container.querySelector(".table__header").addEventListener("click",(e=>{const t=e.target;t.dataset.sort===i.Sort.byWins?this.sort=i.Sort.byWins:t.dataset.sort===i.Sort.byTime&&(this.sort=i.Sort.byTime),this.order=this.order===i.Sort.orderUp?i.Sort.orderDown:i.Sort.orderUp,this.renderWinners()}))}}},607:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(849),n(485);const a=r(n(717));(0,n(134).renderBasicLayout)(),(new a.default).start()}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();